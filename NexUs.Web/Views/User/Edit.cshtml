@{
    ViewData["Title"] = "Actualizar Perfil";
}
@model NexUs.Core.Application.ViewModels.Users.UserViewModel

<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card text-white p-4 shadow-lg">
                <h4 class="mb-4 text-center">Actualizar Perfil</h4>

                @if (Model.HasError)
                {
                    <div class="alert alert-danger alert-dismissible fade show" role="alert">
                        <strong>¡Error!</strong> @Model.Error
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                }

                <form asp-controller="User" asp-action="Update" method="post" enctype="multipart/form-data">
                    <input type="hidden" asp-for="Id" />
                    <input type="hidden" asp-for="ImagePath" />

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label asp-for="FirstName" class="form-label">Nombre</label>
                            <input asp-for="FirstName" class="form-control" placeholder="Ingrese su nombre">
                            <span asp-validation-for="FirstName" class="text-danger"></span>
                        </div>

                        <div class="col-md-6 mb-3">
                            <label asp-for="LastName" class="form-label">Apellido</label>
                            <input asp-for="LastName" class="form-control" placeholder="Ingrese su apellido">
                            <span asp-validation-for="LastName" class="text-danger"></span>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label asp-for="Email" class="form-label">Correo Electrónico</label>
                            <input asp-for="Email" class="form-control" placeholder="ejemplo@dominio.com">
                            <span asp-validation-for="Email" class="text-danger"></span>
                        </div>

                        <div class="col-md-6 mb-3">
                            <label asp-for="UserName" class="form-label">Nombre de Usuario</label>
                            <input asp-for="UserName" class="form-control" placeholder="Ingrese su nombre de usuario">
                            <span asp-validation-for="UserName" class="text-danger"></span>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label asp-for="Password" class="form-label">Contraseña</label>
                            <input asp-for="Password" class="form-control" placeholder="Ingrese su contraseña">
                            <span asp-validation-for="Password" class="text-danger"></span>
                            <small class="form-text text-muted">
                                La contraseña debe tener al menos 8 caracteres, incluyendo una minúscula, una mayúscula, un número y un carácter especial.
                            </small>
                        </div>

                        <div class="col-md-6 mb-3">
                            <label asp-for="ConfirmPassword" class="form-label">Confirmar Contraseña</label>
                            <input asp-for="ConfirmPassword" class="form-control" placeholder="Confirme su contraseña">
                            <span asp-validation-for="ConfirmPassword" class="text-danger"></span>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label asp-for="PhoneNumber" class="form-label">Número Telefónico</label>
                        <input asp-for="PhoneNumber" class="form-control" placeholder="Ejemplo: 8091234567">
                        <span asp-validation-for="PhoneNumber" class="text-danger"></span>
                        <small class="form-text text-muted">
                            El número debe estar en formato RD (809/829/849 seguido de 7 dígitos).
                        </small>
                    </div>

                    <div class="mb-3">
                        <label asp-for="File" class="form-label">Foto de Perfil</label>
                        <div class="d-flex align-items-center">
                            @if (!string.IsNullOrEmpty(Model.ImagePath))
                            {
                                <img src="@Model.ImagePath" alt="Foto de perfil" class="profile-img me-3" style="width: 64px; height: 64px;">
                            }
                            <input asp-for="File" class="form-control" type="file" accept="image/*">
                        </div>
                        <span asp-validation-for="File" class="text-danger"></span>
                        <small class="form-text text-muted">La imagen actual se conservará si no selecciona una nueva.</small>
                    </div>

                    <div class="d-flex justify-content-between mt-4">
                        <a asp-controller="Home" asp-action="Index" class="btn btn-secondary">Volver al Inicio</a>
                        <button type="submit" class="btn" style="background-color: #008f89; color: white;">Guardar Cambios</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Para mostrar el nombre del archivo seleccionado en el input file
        document.querySelector('.custom-file-input').addEventListener('change', function (e) {
            var fileName = e.target.files[0].name;
            var nextSibling = e.target.nextElementSibling;
            nextSibling.innerText = fileName;
        })
    </script>
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}